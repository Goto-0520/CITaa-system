# jichikai-system

体育会自治会の業務を効率化するシステム

## 機能一覧

| 機能 | 状態 | 説明 |
|------|------|------|
| 📋 出欠確認 | ✅ 完成 | フォーム回答と名簿を照合し、未回答者を検出 |
| 📄 名簿PDF生成 | 🚧 開発中 | 団体別にパスワード付きPDFを生成 |
| 💰 会計集計 | 📝 予定 | 収支の自動集計 |
| 📷 書類スキャン | 📝 予定 | OCRでExcelに自動入力 |

## 出欠確認システム (`attendance_checker.py`)

### 概要

マスターリスト（本部員名簿）とアップロードされたデータ（フォーム回答等）を比較し、不在者・未回答者を自動検出します。

### 特徴

- **氏名欄の自動検出**: カラム名やデータパターンから氏名欄を自動判定
- **名前の正規化**: 空白の有無（`千葉 工大` と `千葉工大`）を同一視
- **異体字対応**: `髙橋` と `高橋`、`齋藤` と `斎藤` などを同一視
- **対応ファイル形式**: Excel（.xlsx, .xls）、CSV

### 対応している異体字

| 異体字 | 統一後 |
|--------|--------|
| 髙 | 高 |
| 﨑 | 崎 |
| 齋, 齊, 斉 | 斎 |
| 邉, 邊 | 辺 |
| 澤 | 沢 |
| 濵, 濱 | 浜 |
| 嶋, 嶌 | 島 |
| 惠 | 恵 |
| 廣 | 広 |
| 龍 | 竜 |

### 使い方

#### Google Colabで実行

1. [Google Colab](https://colab.research.google.com/) を開く
2. 「ファイル」→「ノートブックをアップロード」または新規作成
3. コードをセルにコピー＆ペースト
4. 各セルを順番に実行

#### 手順
```
セル1: ライブラリのインストール
    ↓
セル2: マスターリストの設定（必要に応じて編集）
    ↓
セル3: アップロード機能の準備
    ↓
セル4: 氏名欄検出機能の準備
    ↓
セル5: 比較実行（ファイルをアップロード）
```

#### マスターリストの更新

セル2の `master_names` リストを編集してください：
```python
master_names = [
    "山田 太郎",
    "佐藤 花子",
    # ... 追加・削除
]
```

### 出力例
```
📊 比較結果
==================================================
マスターリスト: 103名
確認データ: 98名
不在者: 5名
==================================================

❌ 確認データにいない人:
  1. 山田 太郎
  2. 佐藤 花子
  3. 田中 一郎
  4. 鈴木 次郎
  5. 高橋 三郎

⚠️ マスターリストにない人（2名）:
  1. 外部 参加者
  2. ゲスト 太郎
```

### 必要なライブラリ
```
pandas
numpy
openpyxl
```

※ Google Colabでは自動でインストールされます

## 動作環境

- Google Colab（推奨）
- Python 3.8以上

## Author

後藤寛明 - 千葉工業大学 体育会自治会

## License

MIT License